!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function o(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function t(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(c," ")),u.json?JSON.parse(e):e}catch(n){}}function r(n,o){var i=u.raw?n:t(n);return e.isFunction(o)?o(i):i}var c=/\+/g,u=e.cookie=function(t,c,s){if(arguments.length>1&&!e.isFunction(c)){if(s=e.extend({},u.defaults,s),"number"==typeof s.expires){var d=s.expires,f=s.expires=new Date;f.setMilliseconds(f.getMilliseconds()+864e5*d)}return document.cookie=[n(t),"=",i(c),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}for(var a=t?void 0:{},p=document.cookie?document.cookie.split("; "):[],l=0,m=p.length;m>l;l++){var x=p[l].split("="),g=o(x.shift()),j=x.join("=");if(t===g){a=r(j,c);break}t||void 0===(j=r(j))||(a[g]=j)}return a};u.defaults={},e.removeCookie=function(n,o){return e.cookie(n,"",e.extend({},o,{expires:-1})),!e.cookie(n)}});
window.url=function(){function r(){return new RegExp(/(.*?)\.?([^\.]*?)\.?(com|net|org|biz|ws|in|me|co\.uk|co|org\.uk|ltd\.uk|plc\.uk|me\.uk|edu|mil|br\.com|cn\.com|eu\.com|hu\.com|no\.com|qc\.com|sa\.com|se\.com|se\.net|us\.com|uy\.com|ac|co\.ac|gv\.ac|or\.ac|ac\.ac|af|am|as|at|ac\.at|co\.at|gv\.at|or\.at|asn\.au|com\.au|edu\.au|org\.au|net\.au|id\.au|be|ac\.be|adm\.br|adv\.br|am\.br|arq\.br|art\.br|bio\.br|cng\.br|cnt\.br|com\.br|ecn\.br|eng\.br|esp\.br|etc\.br|eti\.br|fm\.br|fot\.br|fst\.br|g12\.br|gov\.br|ind\.br|inf\.br|jor\.br|lel\.br|med\.br|mil\.br|net\.br|nom\.br|ntr\.br|odo\.br|org\.br|ppg\.br|pro\.br|psc\.br|psi\.br|rec\.br|slg\.br|tmp\.br|tur\.br|tv\.br|vet\.br|zlg\.br|br|ab\.ca|bc\.ca|mb\.ca|nb\.ca|nf\.ca|ns\.ca|nt\.ca|on\.ca|pe\.ca|qc\.ca|sk\.ca|yk\.ca|ca|cc|ac\.cn|com\.cn|edu\.cn|gov\.cn|org\.cn|bj\.cn|sh\.cn|tj\.cn|cq\.cn|he\.cn|nm\.cn|ln\.cn|jl\.cn|hl\.cn|js\.cn|zj\.cn|ah\.cn|gd\.cn|gx\.cn|hi\.cn|sc\.cn|gz\.cn|yn\.cn|xz\.cn|sn\.cn|gs\.cn|qh\.cn|nx\.cn|xj\.cn|tw\.cn|hk\.cn|mo\.cn|cn|cx|cz|de|dk|fo|com\.ec|tm\.fr|com\.fr|asso\.fr|presse\.fr|fr|gf|gs|co\.il|net\.il|ac\.il|k12\.il|gov\.il|muni\.il|ac\.in|co\.in|org\.in|ernet\.in|gov\.in|net\.in|res\.in|is|it|ac\.jp|co\.jp|go\.jp|or\.jp|ne\.jp|ac\.kr|co\.kr|go\.kr|ne\.kr|nm\.kr|or\.kr|li|lt|lu|asso\.mc|tm\.mc|com\.mm|org\.mm|net\.mm|edu\.mm|gov\.mm|ms|nl|no|nu|pl|ro|org\.ro|store\.ro|tm\.ro|firm\.ro|www\.ro|arts\.ro|rec\.ro|info\.ro|nom\.ro|nt\.ro|se|si|com\.sg|org\.sg|net\.sg|gov\.sg|sk|st|tf|ac\.th|co\.th|go\.th|mi\.th|net\.th|or\.th|tm|to|com\.tr|edu\.tr|gov\.tr|k12\.tr|net\.tr|org\.tr|com\.tw|org\.tw|net\.tw|ac\.uk|uk\.com|uk\.net|gb\.com|gb\.net|vg|sh|kz|ch|info|ua|gov|name|pro|ie|hk|com\.hk|org\.hk|net\.hk|edu\.hk|us|tk|cd|by|ad|lv|eu\.lv|bz|es|jp|cl|ag|mobi|eu|co\.nz|org\.nz|net\.nz|maori\.nz|iwi\.nz|io|la|md|sc|sg|vc|tw|travel|my|se|tv|pt|com\.pt|edu\.pt|asia|fi|com\.ve|net\.ve|fi|org\.ve|web\.ve|info\.ve|co\.ve|tel|im|gr|ru|net\.ru|org\.ru|hr|com\.hr|ly|xyz)$/)}function t(r){return decodeURIComponent(r.replace(/\+/g," "))}function c(r,t){var c=r.charAt(0),o=t.split(c);return c===r?o:(r=parseInt(r.substring(1),10),o[0>r?o.length+r:r-1])}function o(r,c){var o=r.charAt(0),n=c.split("&"),e=[],a={},m=[],i=r.substring(1);for(var u in n)if(n.hasOwnProperty(u)&&(e=n[u].match(/(.*?)=(.*)/),e||(e=[n[u],n[u],""]),""!==e[1].replace(/\s/g,""))){if(e[2]=t(e[2]||""),i===e[1])return e[2];m=e[1].match(/(.*)\[([0-9]+)\]/),m?(a[m[1]]=a[m[1]]||[],a[m[1]][m[2]]=e[2]):a[e[1]]=e[2]}return o===r?a:a[i]}return function(t,n){var e,a={};if("tld?"===t)return r();if(n=n||window.location.toString(),!t)return n;if(t=t.toString(),e=n.match(/^mailto:([^\/].+)/))a.protocol="mailto",a.email=e[1];else{if((e=n.match(/(.*?)#(.*)/))&&(a.hash=e[2],n=e[1]),a.hash&&t.match(/^#/))return o(t,a.hash);if((e=n.match(/(.*?)\?(.*)/))&&(a.query=e[2],n=e[1]),a.query&&t.match(/^\?/))return o(t,a.query);if((e=n.match(/(.*?)\:?\/\/(.*)/))&&(a.protocol=e[1].toLowerCase(),n=e[2]),(e=n.match(/(.*?)(\/.*)/))&&(a.path=e[2],n=e[1]),a.path=(a.path||"").replace(/^([^\/])/,"/$1").replace(/\/$/,""),t.match(/^[\-0-9]+$/)&&(t=t.replace(/^([^\/])/,"/$1")),t.match(/^\//))return c(t,a.path.substring(1));if(e=c("/-1",a.path.substring(1)),e&&(e=e.match(/(.*?)\.(.*)/))&&(a.file=e[0],a.filename=e[1],a.fileext=e[2]),(e=n.match(/(.*)\:([0-9]+)$/))&&(a.port=e[2],n=e[1]),(e=n.match(/(.*?)@(.*)/))&&(a.auth=e[1],n=e[2]),a.auth&&(e=a.auth.match(/(.*)\:(.*)/),a.user=e?e[1]:a.auth,a.pass=e?e[2]:void 0),a.hostname=n.toLowerCase(),"."===t.charAt(0))return c(t,a.hostname);r()&&(e=a.hostname.match(r()),e&&(a.tld=e[3],a.domain=e[2]?e[2]+"."+e[3]:void 0,a.sub=e[1]||void 0)),a.port=a.port||("https"===a.protocol?"443":"80"),a.protocol=a.protocol||("443"===a.port?"https":"http")}return t in a?a[t]:"[]"===t?a:void 0}}(),"undefined"!=typeof jQuery&&jQuery.extend({url:function(r,t){return window.url(r,t)}});
function Event(t){this._observer=t,this._listeners=[]}Event.prototype={constructor:"Event",attach:function(t){this._listeners.push(t)},notify:function(t){for(var s=0,e=this._listeners.length;e>s;s++)this._listeners[s](this._observer,t)}};
!function(t){window.frameEndTime=(new Date).getTime();var e={init:function(t,i){return function(){e.fillHtml(t,i),e.bindEvent(t,i)}()},fillHtml:function(t,e){return function(){t.empty(),e.current>1?t.append('<a href="javascript:;" class="prevPage" se-linkid="page-prev">上一页</a>'):(t.remove(".prevPage"),t.append('<span class="disabled" style="display:none;">上一页</span>')),1!=e.current&&e.current>=4&&4!=e.pageCount&&t.append('<a href="javascript:;" class="tcdNumber" se-linkid="page-1">1</a>'),e.current-2>2&&e.current<=e.pageCount&&e.pageCount>5&&t.append("<span>...</span>");var i=e.current-2,a=e.current+2;for((i>1&&e.current<4||1==e.current)&&a++,e.current>e.pageCount-4&&e.current>=e.pageCount&&i--;a>=i;i++)i<=e.pageCount&&i>=1&&(i!=e.current?t.append('<a href="javascript:;" class="tcdNumber" se-linkid="page-'+i+'">'+i+"</a>"):t.append('<span class="current">'+i+"</span>"));e.current+2<e.pageCount-1&&e.current>=1&&e.pageCount>5&&t.append("<span>...</span>"),e.current!=e.pageCount&&e.current<e.pageCount-2&&4!=e.pageCount&&t.append('<a href="javascript:;" class="tcdNumber" se-linkid="page-'+e.pageCount+'">'+e.pageCount+"</a>"),e.current<e.pageCount?t.append('<a href="javascript:;" class="nextPage" se-linkid="page-next">下一页</a>'):(t.remove(".nextPage"),t.append('<span class="disabled" style="display:none;">下一页</span>'))}()},bindEvent:function(i,a){return function(){i.on("click","a.tcdNumber",function(){var n=parseInt(t(this).text());e.fillHtml(i,{current:n,pageCount:a.pageCount}),"function"==typeof a.backFn&&a.backFn(n)}),i.on("click","a.prevPage",function(){var t=parseInt(i.children("span.current").text());e.fillHtml(i,{current:t-1,pageCount:a.pageCount}),"function"==typeof a.backFn&&a.backFn(t-1)}),i.on("click","a.nextPage",function(){var t=parseInt(i.children("span.current").text());e.fillHtml(i,{current:t+1,pageCount:a.pageCount}),"function"==typeof a.backFn&&a.backFn(t+1)})}()}};t.fn.createPage=function(i){var a=t.extend({pageCount:10,current:1,backFn:function(){}},i);e.init(this,a)}}(jQuery);var filterMenu={1:{alias:"order",dft:"0",cell:{1:{val:"totalrank",name:"综合排序"},2:{val:"click",name:"最多点击"},3:{val:"pubdate",name:"最新发布"},4:{val:"dm",name:"最多弹幕"},5:{val:"stow",name:"最多收藏"}}},2:{alias:"duration",dft:"1",cell:{1:{val:"",name:"全部时长"},2:{val:"1",name:"10分钟以下"},3:{val:"2",name:"10-30分钟"},4:{val:"3",name:"30-60分钟"},5:{val:"4",name:"60分钟以上"}}},3:{alias:"tids_1",dft:"1",cell:{1:{alias:"tids_2",val:"",name:"全部分区"},2:{alias:"tids_2",val:"1",name:"动画",cell:{1:{val:"24",name:"MAD·AMV"},2:{val:"25",name:"MMD·3D"},3:{val:"27",name:"综合"},4:{val:"47",name:"短片·手书·配音"}}},3:{alias:"tids_2",val:"13",name:"番剧相关",cell:{1:{val:"32",name:"完结动画"},2:{val:"33",name:"连载动画"},3:{val:"51",name:"资讯"},4:{val:"152",name:"官方延伸"}}},4:{alias:"tids_2",val:"167",name:"国创",cell:{1:{val:"153",name:"国产动画"},2:{val:"168",name:"国产原创相关"},3:{val:"169",name:"布袋戏"},4:{val:"170",name:"资讯"}}},5:{alias:"tids_2",val:"3",name:"音乐",cell:{1:{val:"28",name:"原创音乐"},2:{val:"29",name:"三次元音乐"},3:{val:"30",name:"VOCALOID·UTAU"},4:{val:"31",name:"翻唱"},5:{val:"54",name:"OP/ED/OST"},6:{val:"59",name:"演奏"},7:{val:"130",name:"音乐选集"}}},6:{alias:"tids_2",val:"129",name:"舞蹈",cell:{1:{val:"20",name:"宅舞"},2:{val:"154",name:"三次元舞蹈"},3:{val:"156",name:"舞蹈教程"}}},7:{alias:"tids_2",val:"4",name:"游戏",cell:{1:{val:"17",name:"单机游戏"},2:{val:"171",name:"电子竞技"},3:{val:"172",name:"手机游戏"},4:{val:"65",name:"网络游戏"},5:{val:"173",name:"桌游棋牌"},6:{val:"121",name:"GMV"},7:{val:"136",name:"音游"},8:{val:"19",name:"Mugen"}}},8:{alias:"tids_2",val:"36",name:"科技",cell:{1:{val:"37",name:"纪录片"},2:{val:"39",name:"演讲•公开课"},3:{val:"95",name:"数码"},4:{val:"96",name:"星海"},5:{val:"98",name:"机械"},6:{val:"122",name:"野生技术协会"},7:{val:"124",name:"趣味科普人文"},8:{val:"176",name:"汽车"}}},9:{alias:"tids_2",val:"160",name:"生活",cell:{1:{val:"138",name:"搞笑"},2:{val:"21",name:"日常"},3:{val:"76",name:"美食圈"},4:{val:"75",name:"动物圈"},5:{val:"161",name:"手工"},6:{val:"162",name:"绘画"},7:{val:"175",name:"ASMR"},8:{val:"163",name:"运动"},9:{val:"174",name:"其他"}}},10:{alias:"tids_2",val:"119",name:"鬼畜",cell:{1:{val:"22",name:"鬼畜调教"},2:{val:"26",name:"音MAD"},3:{val:"126",name:"人力VOCALOID"},4:{val:"127",name:"教程演示"}}},11:{alias:"tids_2",val:"155",name:"时尚",cell:{1:{val:"157",name:"美妆"},2:{val:"158",name:"服饰"},3:{val:"164",name:"健身"},4:{val:"159",name:"资讯"}}},12:{alias:"tids_2",val:"165",name:"广告"},13:{alias:"tids_2",val:"5",name:"娱乐",cell:{1:{val:"71",name:"综艺"},2:{val:"137",name:"明星"},3:{val:"131",name:"Korea相关"}}},14:{alias:"tids_2",val:"23",name:"电影",cell:{1:{val:"82",name:"电影相关"},2:{val:"83",name:"其他国家"},3:{val:"85",name:"短片"},4:{val:"145",name:"欧美电影"},5:{val:"146",name:"日本电影"},6:{val:"147",name:"国产电影"}}},15:{alias:"tids_2",val:"11",name:"电视剧",cell:{1:{val:"15",name:"连载剧集"},2:{val:"34",name:"完结剧集"},3:{val:"86",name:"特摄"},4:{val:"128",name:"电视剧相关"}}}}}},drawMenu={1:{alias:"sort_item",dft:"",cell:{1:{val:"0",name:"综合排序"},2:{val:"1",name:"最新发布"},3:{val:"2",name:"最高评分"},4:{val:"3",name:"最多收藏"}}}},commonUtils={subString:function(t,e){t=t.replace(/<[^>]+>/g,"");for(var i=0,a="",n=/[^\x00-\xff]/g,s="",l=t.replace(n,"**").length,o=0;l>o&&(s=t.charAt(o).toString(),null!=s.match(n)?i+=2:i++,!(i>e));o++)a+=s;return l>e&&(a+="..."),a},objToString:function(t){var e="?";for(var i in t)t[i]&&(e+=i+"="+t[i]+"&");return e.replace(/&$/,"")},objToEncodeStr:function(t){var e="?";for(var i in t)t[i]&&(e+=i+"="+encodeURIComponent(t[i])+"&");return e.replace(/&$/,"")},ajax:function(t,e){$.ajax({url:t,success:function(t){e(t)}})},ajaxWithCredential:function(t,e){$.ajax({url:t,xhrFields:{withCredentials:!0},success:function(t){e(t)}})},whereImI:function(){return window.location.pathname.split("/").slice(-1)}};"all"==commonUtils.whereImI()&&(window.onload=function(){var t,e,i=(new Date).getTime(),a=UserStatus.isLogin()?$.cookie("DedeUserID"):void 0;performance&&performance.timing?(e=performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart,t=performance.timing.loadEventStart-performance.timing.navigationStart):(t=i-startTime,e=frameEndTime-startTime),$.ajax({url:"//data.bilibili.com/v/void/web_ld_time",type:"GET",data:{mid:a,info_type:"search_result",ld_time:t}}),$.ajax({url:"//data.bilibili.com/v/void/web_ld_time",type:"GET",data:{mid:UserStatus.isLogin()?$.cookie("DedeUserID"):void 0,info_type:"search_frame",ld_time:e}}),$.ajax({url:"//data.bilibili.com/v/void/web_pic_ld_time",type:"GET",data:{mid:a,ld_time:imgLdTime}})});var search_utils={supports_history_api:function(){return!(!window.history||!history.pushState)}(),ie_url:null,main_url:"//s.search.bilibili.com"};$(function(){function t(t){this.cfg={fold:null,selectedClass:"active",queryObj:null,current:null,pageCount:null,totalNum:null,keyword:"undefined"!=typeof url("?keyword")?url("?keyword"):null,ie_url:null,isSetUrl:!0,isCleanFilter:!1},this.isShowLvChange=new Event(this),this.isShowSexyChange=new Event(this),this.lvSelectChange=new Event(this),this.sexySelectChange=new Event(this),this.reportSexyChange=new Event(this),this.reportLvChange=new Event(this),this.selectedChanging=new Event(this),this.menuUlAdding=new Event(this),this.menuUlRemoving=new Event(this),this.foldChanging=new Event(this),this.queryObjChanging=new Event(this),this.pageChanging=new Event(this),this.pageCountChanging=new Event(this),this.ajaxQuerying=new Event(this),this.ajaxQueryCompleting=new Event(this),this.totalNumChanging=new Event(this),this.liveOrderChanging=new Event(this),this.liveCoverChanging=new Event(this),this.init(t,!1)}function e(t){var e=this;this.mdl=t,this.mdl.queryObjChanging.attach(function(t,i){i.isSetUrl&&(search_utils.supports_history_api?e.setUrlView(i.queryObj):e.locationTo())})}function i(t){var e=this;this.$listWrap=$(".ajax-render"),this.$noResult=$(".no-result"),this.$videoWrap=$("#video-list"),this.$soInfo=$(".soInfo"),this.mdl=t,this.mdl.ajaxQuerying.attach(function(t,i){e.$noResult.hide(),e.$listWrap.show(),e.$listWrap.html(""),e.$listWrap.addClass("loading"),e.$listWrap.append("<div class='ajax-loading'></div>")}),this.mdl.ajaxQueryCompleting.attach(function(t,i){if(i.errTxt)"all"==commonUtils.whereImI()&&"没有相关数据"!==$(".recom-wrap").attr("data-text")&&(0===i.total?e.$noResult.addClass("rec"):e.$noResult.removeClass("rec")),e.$listWrap.hide(),e.$noResult.find(".text").html(i.errTxt),($(".all-other").hasClass("no")||0==$(".all-other").size())&&e.$noResult.show();else{var a=i.html;e.$noResult.hide(),e.$listWrap.show(),e.renderVideoList(a),$(".ajax-render .video > a").each(function(t,e){var i=$(e).attr("href").match(/.*av(\d+)\?/)[1];$(e).find(".img").append('<i class="search-watch-later icon-later-off" data-aid="'+i+'"></i>')}),b.reinit(),"upuser"==commonUtils.whereImI()&&(v.init(),onLoginInfoLoaded(function(t){t.isLogin&&g.checkIfAdd()})),"pgc"==commonUtils.whereImI()&&c.reInit(),"bangumi"==commonUtils.whereImI()&&d.init()}e.$listWrap.removeClass("loading"),e.$listWrap.remove(".ajax-loading")}),this.mdl.queryObjChanging.attach(function(t,e){"all"==commonUtils.whereImI()&&(e.isDisplay?$(".so-wrap .all-other").removeClass("no"):$(".so-wrap .all-other").addClass("no"))})}function a(t,e){var i=this;this.$wrap=$(".paging-wrap"),this.$pageWrap=$("#video-paging"),this.$baiduSearch=$("#video-paging-search"),this.$soInfo=$(".so-info"),this.mdl=t,this.pageClick=new Event(this),this.mdl.queryObjChanging.attach(function(t,e){i.createPageView()}),this.init()}function n(t){var e=this;this.mdl=t,this.$menuWrap=$(".filter-block"),this.$soInfo=$(".so-info"),this.$liveOrder=$(".live-room .sort-filter a"),this.$liveCover=$(".live-room .face-filter a"),this.itemClick=new Event(this),this.itemClicking=new Event(this),this.foldClicking=new Event(this),this.switchClicking=new Event(this),this.liveCoverClick=new Event(this),this.liveOrderClick=new Event(this),this.mdl.selectedChanging.attach(function(t,i){var a=i.$ele,n=i.sltStyle;e.selectedChange(a,n)}),this.mdl.menuUlAdding.attach(function(t,i){e.buildUl(i.itemObj,i.pAlias,i.level,i.leftPos)}),this.mdl.menuUlRemoving.attach(function(t,i){e.menuUlRemove(i.alias)}),this.mdl.foldChanging.attach(function(){e.setFoldView(e.mdl.getFold())}),this.$menuWrap.click(function(t){e.itemClick.notify({eObj:t})}),this.$menuWrap.find(".fold").click(function(t){e.foldClicking.notify({eObj:this})}),this.$soInfo.find(".js-video-switch").click(function(t){e.switchClicking.notify({eObj:this})}),"all"==commonUtils.whereImI()||"video"==commonUtils.whereImI()?this.init(!0):"drawyoo"==commonUtils.whereImI()&&this.init()}function s(t,e,i){var a=this;"lv"==e?(this.cur="curLv",this.isShow="isShowLv"):(this.cur="curSexy",this.isShow="isShowSexy"),this.$component=$(".select-component."+e),this.selectMenu=t,this.type=e,this.model=i,this.init(),this.bindClickCurrent(),this.bindClickSelectItem(),this.bindBodyClick(),"lv"==e?(this.model.isShowLvChange.attach(function(t,e){a.changeShowView()}),this.model.lvSelectChange.attach(function(t,e){a.changeCurView(e.$dom,e.type)}),this.model.reportLvChange.attach(function(t,e){a.clickReport(e)})):(this.model.isShowSexyChange.attach(function(t,e){a.changeShowView()}),this.model.sexySelectChange.attach(function(t,e){a.changeCurView(e.$dom,e.type)}),this.model.reportSexyChange.attach(function(t,e){a.clickReport(e)}))}function l(e){this.sortModel=new t(e),this.init(this.sortModel)}function o(t){return t=t.toString(),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/"/g,"&#34;"),t=t.replace(/'/g,"&#39;")}var r=(function(){var t=$(".wrap .hover-bar"),e=$(".wrap"),i=null,a=e.find(".sub.active").position()?e.find(".sub.active").position().left:null;!function(){null!=a&&t.css({left:a+"px",display:"block"})}(),e.find(".sub").on("mouseenter",function(){var e=$(this).position().left;i&&clearTimeout(i),i=setTimeout(function(){t.animate({left:e+"px"},200,"linear")},100)}),e.find(".sub").on("mouseleave",function(){i&&clearTimeout(i)}),e.on("mouseleave",function(){i&&clearTimeout(i),i=setTimeout(function(){null!=a&&t.animate({left:a+"px"},200,"linear")},200)})}(),{pageCount:$("body").data("num_pages"),current:$("body").data("cur_page"),total:$("body").data("total"),keyword:$("body").attr("data-keyword")}),c=function(){function t(){s=$("body").attr("data-trackid"),$.each($dom,function(t,i){var a=$(i).data("id");e(a,i)})}function e(t,e){var a=l.replace(/\{id\}/,t);commonUtils.ajax(a,function(t){t=t.reverse();for(var a="",n=0;n<=t.length-1;n++){var s=t[n].episode;if(-1==t[n].episode&&(s="全集"),12==n){$(e).find(".list-more").addClass("show");break}a+=i(t[n].aid,s,n)}0==t.length&&(a='<p class="text">暂时没有内容</p>'),$(e).prepend(a)})}function i(t,e,i){return o.replace(/\{id\}/,t).replace(/\{seid\}/,s).replace(/\{id\}/,t).replace(/\{no\}/,i).replace(/\{index\}/,e)}function a(){t()}function n(){$dom=$(".js-tvplay .synthetical .so-episode"),t()}$dom=$(".js-tvplay .synthetical .so-episode");var s="",l=($dom.length,"//www.bilibili.com/index/bangumi/{id}.json"),o='<a class="list" href="//www.bilibili.com/video/av{id}?from=search&seid={seid}" target="_blank" se-linkid="tv-{id}-{no}">{index}</a>';return{init:a,reInit:n}}();t.prototype={constructor:"SortModel",init:function(t,e){var i=this;if(this.setFold("true"==$.cookie("fold")),$.extend(this.cfg,t),this.cfg.current=r.current,this.cfg.pageCount=r.pageCount,this.cfg.totalNum=r.total,this.cfg.keyword=r.keyword,this.cfg.menu&&!i.cfg.isCleanFilter&&null!=this.cfg.queryObj){var a="";if("drawyoo"==commonUtils.whereImI())null!=this.cfg.queryObj.sort_item&&(a=this.cfg.queryObj.sort_item,this.cfg.selected[1]=this.getLevelByVal(a,"1"));else if(null!=this.cfg.queryObj.order&&(a=this.cfg.queryObj.order,this.cfg.selected[1]=this.getLevelByVal(a,"1")),null!=this.cfg.queryObj.duration&&(a=this.cfg.queryObj.duration,this.cfg.selected[2]=this.getLevelByVal(a,"2")),null!=this.cfg.queryObj.tids_1){a=this.cfg.queryObj.tids_1,this.cfg.selected[3]=this.getLevelByVal(a,"3");var n=this.cfg.selected[3],s="3."+n;null!=this.cfg.menu[3].cell&&null!=this.cfg.menu[3].cell[n]&&(null!=this.cfg.menu[3].cell[n].cell&&this.cfg.menuStru.push(s),null!=this.cfg.queryObj.tids_2&&(a=this.cfg.queryObj.tids_2,this.cfg.selected[s]=this.getLevelByVal(a,s)))}}},getLevelByVal:function(t,e){for(var i,a=this.getLevelArr(e),n=this.cfg.menu,s=0;s<a.length;s++){n=n[a[s]].cell;for(var l in n)if(n[l].val==t){i=l;break}}return i},getLevelArr:function(t){var t=t.toString(),e=t.split(".");return e},getMenuObjByLevel:function(t){var e=null,i=this.getLevelArr(t);if(null!=i&&i.length>0){e=this.cfg.menu;for(var a=0;a<i.length;a++)e=a==i.length-1?e[i[a]]:e[i[a]].cell}return e},getParentLevel:function(t){var e="",i=this.getLevelArr(t);if(i.length>1)for(var a=0;a<i.length-1;a++)e=0==a?i[a]:e+"."+i[a];return e.toString()},getAlias:function(t){var e=this.getLevelArr(t),i="",a=null;if(null!=e&&e.length>0){a=this.cfg.menu;for(var n=0;n<e.length&&(a=a[e[n]],null!=a.cell);n++)i=a.alias,a=a.cell}return i},getAliasBySelected:function(t,e){var i=this.getLevelArr(t),a="",n=null;if(null!=i&&i.length>0){n=this.cfg.menu;for(var s=0;s<i.length;s++)a=n[i[s]].alias,n=n[i[s]].cell}return a},getParentAliasByLevel:function(t){var e=this.getLevelArr(t),i="",a=null;if(null!=e&&e.length>0&&(a=this.cfg.menu,e.length>1))for(var n=0;n<e.length;n++)a=a[e[n]],n==e.length-2&&(i=a.alias),a=a.cell;return i},getValBySelected:function(t,e){var i="";if(null!=e){var a=this.getLevelArr(t),n=null;if(null!=a&&a.length>0){n=this.cfg.menu;for(var s=0;s<a.length;s++)n=n[a[s]].cell;i=n[e].val}}return i},setFold:function(t){this.cfg.fold=t,$.cookie("fold",t),this.foldChanging.notify()},getFold:function(){return this.cfg.fold},isToFold:function(){var t=!0,e=this.cfg.menu,i=this.cfg.selected;for(var a in e){var n=e[a].dft;if(null!=n&&"0"!=n&&i[a]!=n){t=!1;break}}return t},setQueryObj:function(){var t=this;if(this.cfg.queryObj={},this.cfg.keyword&&(this.cfg.queryObj.keyword=this.cfg.keyword),this.cfg.current&&(this.cfg.queryObj.page=this.cfg.current),"live"==commonUtils.whereImI())"undefined"==typeof url("?type")||""==url("?type")||"all"==url("?type")?(this.cfg.queryObj.type="all",this.cfg.queryObj.order=this.cfg.order,this.cfg.queryObj.coverType=this.cfg.coverType):"user"==url("?type")?this.cfg.queryObj.type="user":this.cfg.queryObj.type=url("?type");else if("all"==commonUtils.whereImI()||"video"==commonUtils.whereImI()){for(var e=this.cfg.menuStru,i=this.cfg.selected,a=!0,n=0;n<e.length;n++){var s=e[n],l=i[s],o=this.getAliasBySelected(s,l),r=this.getValBySelected(s,l);null!=r&&r.length>0&&(this.cfg.queryObj[o]=r),"1"!=s&&"2"!=s&&"3"!=s||a&&"1"!=l&&(a=!1)}a&&1!=this.cfg.current&&(a=!1)}else if("drawyoo"==commonUtils.whereImI())for(var i=this.cfg.selected,e=this.cfg.menuStru||[],n=0;n<e.length;n++){var s=e[n],l=i[s],o=this.getAliasBySelected(s,l),r=this.getValBySelected(s,l);null!=r&&r.length>0&&(this.cfg.queryObj[o]=r)}else"upuser"==commonUtils.whereImI()&&(this.cfg.queryObj.lv=this.cfg.curLv,this.cfg.queryObj.sexy=this.cfg.curSexy);t.cfg.isSetUrl&&!search_utils.supports_history_api?(t.setIeUrl(),window.location.href=t.cfg.ie_url):t.queryObjChanging.notify({queryObj:t.cfg.queryObj,isDisplay:a,isSetUrl:t.cfg.isSetUrl}),t.ajaxQuery(t.cfg.queryObj)},ajaxQuery:function(t){this.ajaxQuerying.notify();var e=this,i="/all"==url("path")?"/video":url("path"),a=encodeURI("/ajax_api/"+i.split("/").slice(-1).toString().toLowerCase());t._=(new Date).getTime(),$.ajax({url:a,dataType:"json",data:t}).then(function(t){if("all"==commonUtils.whereImI()){0==t.code?1:2,UserStatus.isLogin()?$.cookie("DedeUserID"):void 0}var i=t.code,a=t.trackid,n=null;$("body").attr({"data-trackid":a}),0!=i&&(n=t.text);var n=t.text,s=t.html;e.setPageCount(t.numPages),e.setTotalNum(t.numResults?t.numResults>=1e3?"1000+":t.numResults:0),e.ajaxQueryCompleting.notify({html:s,total:e.cfg.totalNum,code:i,errTxt:n})},function(){})},deleteMenuByLevel:function(t,e){if(this.cfg.menuStru.indexOf(t)>=0){var i=this.cfg.menuStru.indexOf(t);this.cfg.menuStru.splice(i,1),this.deleteSelectByLevel(t,e)}},deleteSelectByLevel:function(t,e){delete this.cfg.selected[t],this.menuUlRemoving.notify({alias:e})},addMenuByLevel:function(t,e,i){if(this.cfg.menuStru.push(t),e){var a=this.getMenuObjByLevel(t),n=this.getParentAliasByLevel(t);this.menuUlAdding.notify({itemObj:a,pAlias:n,level:t,leftPos:i})}},setSelected:function(t,e,i){var a=this;this.cfg.selected[t]=e,this.selectedChanging.notify({$ele:i,sltStyle:a.cfg.selectedClass})},setCurrentPage:function(t,e){this.cfg.current=t,this.pageChanging.notify({cPage:t}),e&&this.setQueryObj()},setPageCount:function(t){t!=this.cfg.pageCount&&(this.cfg.pageCount=t,this.pageCountChanging.notify({pCount:t}))},setTotalNum:function(t){t!=this.cfg.totalNum&&(this.cfg.totalNum=t,this.totalNumChanging.notify({num:t}))},setLiveCover:function(t){this.cfg.coverType=t,this.setCurrentPage(1,!1),this.setQueryObj()},setLiveOrder:function(t){this.cfg.order=t,this.setCurrentPage(1,!1),this.setQueryObj()},setIeUrl:function(){this.cfg.ie_url="//"+location.host+"/"+commonUtils.whereImI()+commonUtils.objToEncodeStr(this.cfg.queryObj)},setLvShow:function(t){t?this.cfg.isShowLv=!1:(!this.cfg.isShowLv&&this.cfg.isShowSexy&&this.setSexyShow(),this.cfg.isShowLv=!this.cfg.isShowLv),this.isShowLvChange.notify()},setSexyShow:function(t){t?this.cfg.isShowSexy=!1:(!this.cfg.isShowSexy&&this.cfg.isShowLv&&this.setLvShow(),this.cfg.isShowSexy=!this.cfg.isShowSexy),this.isShowSexyChange.notify()},setCurLv:function(t,e){var i=this.cfg.curLv,a=t;this.cfg.curLv=t,this.setCurrentPage(1,!1),this.lvSelectChange.notify({$dom:e,type:"lv"}),this.setQueryObj(),this.reportLvChange.notify({type:"lv",from:i,to:a})},setCurSexy:function(t,e){var i=this.cfg.curSexy,a=t;this.cfg.curSexy=t,this.setCurrentPage(1,!1),this.sexySelectChange.notify({$dom:e,type:"sexy"}),this.setQueryObj(),this.reportSexyChange.notify({type:"sexy",from:i,to:a})}},e.prototype={setUrlView:function(t){history.replaceState(url("?"),"",commonUtils.objToEncodeStr(t))},locationTo:function(){var t=this;window.location.href=encodeURI(t.mdl.cfg.ie_url)}},i.prototype={renderVideoList:function(t){this.$listWrap.html("").append(t)}},a.prototype={init:function(){var t=this;this.createPageView(),this.setIsshowRecom(),this.mdl.pageCountChanging.attach(function(){t.createPageView(),$("body").attr("data-num_pages",t.mdl.cfg.pageCount)}),this.mdl.pageChanging.attach(function(){t.setIsshowRecom()}),this.mdl.totalNumChanging.attach(function(){var e=(t.mdl.cfg.pageCount,t.mdl.cfg.totalNum);$("body").attr("data-total",e),t.setIsshowRecom(),t.setSoInfo(e)})},createPageView:function(){var t,e=this,i=this.mdl.cfg.current;t=this.mdl.cfg.pageCount?this.mdl.cfg.pageCount:1,1==t?e.$wrap.css({display:"none"}):e.$wrap.css({display:"block"}),this.$pageWrap.html("").off(),this.$pageWrap.createPage({pageCount:t,current:i,backFn:function(t){if(e.pageClick.notify({num:t}),"all"==commonUtils.whereImI()){var i=$(".filter-block").offset().top;$("html,body").scrollTop(i-50)}else $("html,body").scrollTop(45)}})},setBaiduSearch:function(t){this.$baiduSearch.attr({href:this.$baiduSearch.attr("href")+encodeURIComponent(t)}),this.$baiduSearch.html("用百度搜索"+t+">")},setSoInfo:function(t){"live"==commonUtils.whereImI()?"undefined"==typeof url("?type")||""==url("?type")||"all"==url("?type")?$(".live-room .headline .num").html(t):"user"==url("?type")&&$(".live-user .headline .num").html(t):"upuser"==commonUtils.whereImI()?this.$soInfo.find(".so-info-total").html("共找到"+t+"个up主"):this.$soInfo.find(".so-info-total").html("共"+t+"条数据")},setIsshowRecom:function(){var t=this;"all"==commonUtils.whereImI()&&(!t.mdl.cfg.pageCount||t.mdl.cfg.pageCount&&t.mdl.cfg.pageCount<=3&&t.mdl.cfg.current===t.mdl.cfg.pageCount&&(t.mdl.cfg.totalNum<46&&t.mdl.cfg.totalNum>40||t.mdl.cfg.totalNum<26&&t.mdl.cfg.totalNum>20||t.mdl.cfg.totalNum<6&&t.mdl.cfg.totalNum>-1))?t.loadRecom().then(function(){var e=$(".recom-wrap"),i=e.find(".separate"),a=i.find(".txt"),n=i.find(".i-txt"),s="";e.length&&("all"==commonUtils.whereImI()&&(!t.mdl.cfg.pageCount||t.mdl.cfg.pageCount&&t.mdl.cfg.pageCount<=3&&t.mdl.cfg.current===t.mdl.cfg.pageCount&&(t.mdl.cfg.totalNum<46&&t.mdl.cfg.totalNum>40||t.mdl.cfg.totalNum<26&&t.mdl.cfg.totalNum>20||t.mdl.cfg.totalNum<6&&t.mdl.cfg.totalNum>-1))?(t.mdl.cfg.pageCount?1===t.mdl.cfg.pageCount?(a.text("宝宝尽力了，只找到这些"),s="ht80",n.show(),n.hasClass("only")||n.addClass("only")):(a.text("看完了呢，没过瘾？"),s="ht80",n.show(),n.hasClass("only")&&n.removeClass("only")):(a.text("肥肠抱歉，没有找到你要的内容 T_T"),n.hide(),s="ht50"),e.show().removeClass("ht80 ht50").addClass(s)):e.hide())}):$(".recom-wrap").hide()},loadRecom:function(){var t=this,e=new Promise(function(e,i){var a=$(".recom-wrap"),n=$("body"),s=n.data("keyword"),l=0,o=2;o>l?l++:l=1,$.ajax({url:"/ajax_api/recommend",dataType:"json",data:{keyword:s,page:l},success:function(i){a.html(i.html).attr("data-trackid",i.trackid).attr("data-text",i.text),o=i.numPages,t.webp(),e()}})});return e},webp:function(){var t=$(".recom-wrap"),e=Array.prototype.slice.call(t.find(".recom-pic"));for(var i in e){var a=$(e[i]),n=a.data("width"),s=a.data("height"),l=a.data("src");a.attr("src",utils.webp(l,{w:n,h:s}))}}},n.prototype={constructor:"SortView",setSelectedClass:function(){var t=this.mdl.cfg.menuStru,e=this.mdl.cfg.selected,i=this.mdl.cfg.selectedClass;if(t)for(var a=0;a<t.length;a++){var n=t[a],s=e[n],l=n;null!=s&&(l=l+"."+s),this.mdl.cfg.$menuWrap.find("li").each(function(t,e){return $(this).attr("data-level")==l?($(this).siblings("li").removeClass(i),$(this).addClass(i),!1):void 0})}},setFoldView:function(t){var e=this.$menuWrap,i=e.find(".fold"),a=this.mdl.cfg.menuStru[0],n=(this.mdl.getLevelArr(a),this.mdl.getAlias(a));t?(e.addClass("no-border"),$(".fold").html("更多筛选&nbsp;<i class='arrow-bottom'></i>"),$(".fold").addClass("on"),e.children("ul").each(function(t,e){$(this).attr("id")!=n&&$(this).css({display:"none"})})):(this.$menuWrap.removeClass("no-border"),i.html("收起筛选&nbsp;<i class='arrow-up'></i>"),i.removeClass("on"),e.children("ul").each(function(t,e){$(this).css({display:"block"})}))},selectedChange:function(t,e){t.siblings().removeClass(e),t.addClass(e)},buildUl:function(t,e,i,a){if(null!=t.cell){var n=t.alias,s="",l="";for(var o in t.cell){var r=t.cell,c=i+"."+o,d='<li class="filter-item" data-val="{val}" data-level="{level}" data-sub="{subAlias}" se-linkid="{alias}-{val}"><a href="javascript:;" >{name}</a></li>';d=d.replace(/\{val\}/,r[o].val).replace(/\{level\}/,c).replace(/\{subAlias\}/,null==r[o].alias||""==r[o].alias?"":r[o].alias).replace(/\{alias\}/,n).replace(/\{val\}/,null==r[o].val||""==r[o].val?"0":r[o].val).replace(/\{name\}/,r[o].name),l+=d}if($("#"+n).length>0)$("#"+n).html()!=l&&$("#"+n).html(l);else if(null!=e&&e.length>0){if(s="<ul id='{alias}' style='display:none;'>"+l+"<i class='icon-tid2-arr'></i></ul>",s=s.replace(/\{alias\}/,n),s=$(s).addClass("sub"),$("#"+e).after(s),void 0==a)try{var u=$("#"+e).children("[data-level='"+i+"']");a=u.position().left+u.outerWidth()/2}catch(h){a=0}var f=$("#"+n).outerWidth(),m=(a-5)/f*100;f/2>a?($("#"+n).find(".icon-tid2-arr").css({left:a-5+"px"}),$("#"+n).css({transform:"scale(1)",transformOrigin:m+"% center",display:"inline-block"})):880>=f/2+a?($("#"+n).find(".icon-tid2-arr").css({left:f/2-5+"px"}),$("#"+n).css({left:a-f/2+"px",transform:"scale(1)",display:"inline-block"})):(m=(f-(880-a))/f*100,$("#"+n).find(".icon-tid2-arr").css({right:880-a-5+"px"}),$("#"+n).css({left:880-f+"px",transform:"scale(1)",transformOrigin:m+"% center",display:"inline-block"}))}else{s="<ul id='{alias}'>"+l+"</ul>",s=s.replace(/\{alias\}/,n);var p=this.$menuWrap;p.append(s)}}},buildMenu:function(t){if(null!=t&&t.length>0)for(var e=0;e<t.length;e++){var i=this.mdl.getMenuObjByLevel(t[e]),a=this.mdl.getParentAliasByLevel(t[e]);this.buildUl(i,a,t[e])}if($(".menu-loading").remove(),"all"==commonUtils.whereImI()){var n,s=(new Date).getTime();n=performance&&performance.timing?s-performance.timing.navigationStart:s-startTime,$.ajax({url:"//data.bilibili.com/v/void/web_ld_time",type:"GET",data:{mid:UserStatus.isLogin()?$.cookie("DedeUserID"):void 0,info_type:"search_filter",ld_time:n}})}},menuUlRemove:function(t){$("#"+t).length>0&&$("#"+t).remove()},init:function(t){this.buildMenu(this.mdl.cfg.menuStru),this.setSelectedClass(),t&&this.setFoldView(this.mdl.cfg.fold)}},s.prototype={constructor:s,findItemByVal:function(t,e){for(var i=0;i<e.length;i++)if(e[i].val==t)return e[i]},init:function(){var t=this.model.cfg[this.cur],e=this.findItemByVal(t,this.selectMenu),i='<div class="current-select" data-value="{index}"><span>{value}</span><i class="triangle-down"></i></div><div class="select-wrap"></div>',a='<span class="select-item {className}" data-value="{index}">{value}</span>';this.$component.append(i.replace(/\{index\}/,t).replace(/\{value\}/,e.alias||e.value));var n=this.$component.find(".select-wrap");this.selectMenu.forEach(function(e,i){var s=e.val==t?"selected":"";n.append(a.replace(/\{className\}/,s).replace(/\{index\}/,e.val).replace(/\{value\}/,e.value))})},bindClickCurrent:function(){var t=this,e=this.$component.find(".current-select");this.$component.find(".select-wrap");e.on("click",function(){"lv"==t.type?t.model.setLvShow():t.model.setSexyShow()})},bindClickSelectItem:function(){var t=this,e=this.$component.find(".select-item");this.$component.find(".current-select");e.on("click",function(e){if(e.preventDefault(),!$(this).hasClass("selected")){var i=$(this).data("value");"lv"==t.type?(t.model.setCurLv(i,$(this)),t.model.setLvShow()):(t.model.setCurSexy(i,$(this)),t.model.setSexyShow())}})},bindBodyClick:function(){var t=this;this.$component.on("click",function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}),$("body").on("click",function(){"lv"==t.type?t.model.setLvShow(!0):"sexy"==t.type&&t.model.setSexyShow(!0)})},changeCurView:function(t,e){var i=this.model.cfg[this.cur],a=this.findItemByVal(i,this.selectMenu),n=a.alias||a.value,s=this.$component.find(".current-select");s.data("value",i),s.find("span").html(n),t.addClass("selected").siblings().removeClass("selected")},changeShowView:function(t){var e=this.model.cfg[this.isShow];e?(this.$component.find(".select-wrap").show(),this.$component.find(".triangle-down").addClass("on")):(this.$component.find(".select-wrap").hide(),this.$component.find(".triangle-down").removeClass("on"))},clickReport:function(t){var e,i;e="lv"==t.type?"filter_level":"filter_sex",i={linkid:e,trackid:$("body").attr("data-trackid"),from:t.from,to:t.to},rec_rp("search_click",i)}},l.prototype={init:function(t){var l=this;"all"!=commonUtils.whereImI()&&"video"!=commonUtils.whereImI()||(this.sortView=new n(t),this.sortView.foldClicking.attach(function(t,e){var i=e.eObj;l.foldClickCtrl($(i))}),this.sortView.switchClicking.attach(function(t,e){var i=e.eObj;l.switchClickCtrl($(i))}),this.sortView.itemClick.attach(function(t,e){var i=e.eObj;$(i.target).parent().hasClass("filter-item")&&l.itemClickCtrl($(i.target))})),"drawyoo"==commonUtils.whereImI()&&(this.sortView=new n(t),this.sortView.itemClick.attach(function(t,e){var i=e.eObj;$(i.target).parent().hasClass("filter-item")&&l.itemClickCtrl($(i.target))})),"all"!=commonUtils.whereImI()&&"bangumi"!=commonUtils.whereImI()||d.init(),"live"==commonUtils.whereImI()&&(this.sortView=new n(t),this.sortView.$liveOrder&&this.sortView.$liveOrder.click(function(){$(this).siblings().removeClass("active"),$(this).remove("active").addClass("active"),l.sortModel.setLiveOrder($(this).data("order"))}),this.sortView.$liveCover&&this.sortView.$liveCover.click(function(){$(this).siblings().removeClass("active"),$(this).remove("active").addClass("active"),l.sortModel.setLiveCover($(this).data("cover"))})),"upuser"==commonUtils.whereImI()&&(this.lvSelectView=new s(h,"lv",t),this.sexySelectView=new s(f,"sexy",t)),this.vListView=new i(t),this.urlView=new e(t),this.pageView=new a(t),this.pageView.pageClick.attach(function(t,e){var i=e.num;l.pageClickCtrl(i)})},itemClickCtrl:function(t){var e=this,i=t.parent("li"),a=i.attr("data-level").toString(),a=i.attr("data-level").toString(),n=this.sortModel.getLevelArr(a),s=this.sortModel.getParentLevel(a).toString(),l=n[n.length-1];if(i.data("sub")){var o=t.position().left+t.outerWidth()/2,r=i.data("sub"),c=this.sortModel.cfg.menuStru;c.indexOf(a)<0?i.siblings().each(function(t,i){var a=$(this).attr("data-level").toString();e.sortModel.deleteMenuByLevel(a,r)}):e.sortModel.deleteSelectByLevel(a,r),this.sortModel.addMenuByLevel(a,!0,o)}this.sortModel.setSelected(s,l,i),this.sortModel.setCurrentPage(1,!0)},foldClickCtrl:function(t){t.hasClass("on")?this.sortModel.setFold(!1):this.sortModel.setFold(!0)},pageClickCtrl:function(t){this.sortModel.setCurrentPage(t,!0)},switchClickCtrl:function(t){t.addClass("active").siblings().removeClass("active"),$(".so-info").find(".js-video-switch").eq(0).hasClass("active")?($(".ajax-render").find(".video:not(.av)").removeClass("list").addClass("matrix"),$.cookie("s_l_s","0",{expires:7})):($(".ajax-render").find(".video").removeClass("matrix").addClass("list"),$.cookie("s_l_s","1",{expires:7}))}},SearchHistory.save(o(r.keyword));var d=function(){function t(){$(".so-episode").on("click",".list.more",function(t){$(this).parent(".so-episode").addClass("showall");var e=$(this).parent(".so-episode.showall").height()-40;$(this).parents(".synthetical").css({height:120+e+"px"})}),$(".so-episode").on("click",".list.collapse",function(t){$(this).parents(".synthetical").css({height:120}),$(this).parent(".so-episode").removeClass("showall")})}return{init:t}}(),u={urlStr:url(),queryObj:url("?"),$menuWrap:$(".filter-block")};if("live"==commonUtils.whereImI())$.extend(u,{order:url("?order")?url("?order"):"online",coverType:url("?coverType")?url("?coverType"):"user_cover"});else if("drawyoo"==commonUtils.whereImI())$.extend(u,{menu:drawMenu,menuStru:["1"],selected:{1:"1"}});else if("all"==commonUtils.whereImI()||"video"==commonUtils.whereImI())$.extend(u,{menu:filterMenu,menuStru:["1","2","3"],selected:{1:"1",2:"1",3:"1"}});else if("upuser"==commonUtils.whereImI()){var h=[{val:"-1",value:"全部",alias:"Lv等级"},{val:"6",value:"Lv6"},{val:"5",value:"Lv5"},{val:"4",value:"Lv4"},{val:"3",
value:"Lv3"},{val:"2",value:"Lv2"},{val:"1",value:"Lv1"},{val:"0",value:"LV0"}],f=[{val:"-1",value:"全部",alias:"性别"},{val:"1",value:"男"},{val:"2",value:"女"},{val:"3",value:"保密"}],m=url("?lv"),p=url("?sexy");h[m]||(m="-1"),f[p]||(p="-1"),$.extend(u,{curLv:m,curSexy:p,isShowLv:!1,isShowSexy:!1})}var v=(new l(u),function(){function t(){e&&e.off("mouseenter").off("mouseleave"),e=$(".up-item .video-item"),e.on("mouseenter",function(t){var e=$(this).offset(),o=e.top,r=e.left,c=$(this).data("title"),d=$(this).data("uname"),u=$(this).data("pubdate"),h=$(this).data("pic");try{h=utils.webp(h,{w:a,h:n})}catch(t){}var f=$(this).data("desc"),m=$(this).data("play"),p=$(this).data("dm"),v=$(this).data("fav"),g=$(this).data("coin");i&&i.remove(),i=$(s.replace(/\{title\}/,c).replace(/\{uname\}/,d).replace(/\{pubdate\}/,u).replace(/\{pic\}/,h).replace(/\{desc\}/,f).replace(/\{playNum\}/,m).replace(/\{dmNum\}/,p).replace(/\{favNum\}/,v).replace(/\{coinNum\}/,g)),l&&clearTimeout(l),l=setTimeout(function(){i.css({top:o-200+"px",left:r+"px"}).appendTo("body").show()},200)}).on("mouseleave",function(){l&&clearTimeout(l),l=setTimeout(function(){i.remove()},200)})}var e,i,a=192,n=120,s='<div class="video-hover-wrap"><p class="video-title">{title}</p><div class="up-info"><span class="upname">{uname}</span><span class="pubdate">{pubdate}</span></div><div class="video-info"><div class="pic-wrap default-img-big"><img src="{pic}" alt="" class="video-pic"></div><p class="desc">{desc}</p></div><div class="nums"><div class="num play"><i  class="icon-playtime"></i><span>{playNum}</span></div> <div class="num dm"><i class="icon-dm"></i><span>{dmNum}</span></div><div class="num fav"><i class="icon-fav"></i><span>{favNum}</span></div><div class="num coin"><i class="icon-coin"></i><span>{coinNum}</span></div></div></div>',l=null;return{init:t}}());v.init();var g=function(){function t(){var t,a,s=$(this),l=s.data("id"),o=s.hasClass("already"),r=s.attr("data-num");o?(t="upuser_unatt_"+r,i(this,l,function(){s.removeClass("already").html("+ 关注").off()})):(t="upuser_att_"+r,e(this,l,function(){s.addClass("already").html("已关注"),n(s)})),a={linkid:t,upid:l,trackid:"upuser"==commonUtils.whereImI()?$("body").attr("data-trackid"):$("body").attr("data-trackid_special")},rec_rp("search_click",a)}function e(t,e,i){return UserStatus.isLogin(t)?void a(t,e,1,function(a){0==a.code?(window.AttentionList.push(e),resetAttentionCache(),(new MessageBox).show(t,"关注成功!",1e3,"ok"),"undefined"!=typeof i&&i(a)):(new MessageBox).show(t,a.msg,2e3,"warning")}):!1}function i(t,e,i){return UserStatus.isLogin(t)?void a(t,e,2,function(a){if(0==a.code){var n=window.AttentionList.indexOf(e);-1!=n&&(window.AttentionList.splice(n,1),resetAttentionCache()),(new MessageBox).show(t,"取消关注成功!",1e3,"ok"),"undefined"!=typeof i&&i(a)}else(new MessageBox).show(t,a.msg,2e3,"warning")}):!1}function a(t,e,i,a){Bilibili.initCrossdomain(),"function"==typeof e?(a=e,e=t,t=null):"undefined"==typeof e&&(e=t,t=null),$.ajax({url:"//api.bilibili.com/x/relation/modify",data:{fid:e,act:i,re_src:120,jsonp:"jsonp"},dataType:"json",type:"post",xhrFields:{withCredentials:!0},success:function(e){"undefined"==typeof a?0==e.code?(new MessageBox).show(t,"关注成功!",1e3,"ok"):(new MessageBox).show(t,e.msg,2e3,"warning"):a(e)}})}function n(t){t.hover(function(){t.html("取消关注")},function(){t.html("已关注")})}function s(){var t=[];$.each($(".js-attention-user"),function(e,i){var a=$(i).data("id");t.push(a)});var e=t.join(",");e&&$.ajax({url:"//api.bilibili.com/x/relation/relations",type:"GET",data:{jsonp:"jsonp",fids:e},xhrFields:{withCredentials:!0},success:function(t){window.AttentionList=[];var e=t.data;if(0==t.code&&e){for(var i in e)window.AttentionList.push(i);for(var a=0;a<window.AttentionList.length;a++)o[window.AttentionList[a]]=!0}$.each($(".js-attention-user"),function(t,e){var i=$(e).data("id");o[i]&&($(e).addClass("already").html("已关注"),n($(e)))})}})}function l(e){$("."+e).on("click",".js-attention-user",t),s()}var o={};return{checkIfAdd:s,init:l}}(),w=function(){function t(){s(),r&&r.off().on("click",".js-tag-btn",i)}function e(){r&&r.off().on("click",".js-tag-btn",function(){var t=$(this),e={linkid:t.data("linkid"),linktype:t.data("linktype"),trackid:$("body").attr("data-trackid_special"),tagid:$(this).data("tagid")};rec_rp("search_click",e),window.biliQuickLogin(function(){window.loadLoginStatus&&window.loadLoginStatus(!0),setTimeout(s(),1)})})}function i(){var t=$(this),e=$(this).parent(),i=$(this).siblings(".tag-num"),s=$(this).data("tagid"),o=i.data("num");$(this).hasClass("has-atten")?n(s,function(a){a&&0==a.code&&(t.removeClass("has-atten"),t.text("+关注"),Number(o)&&(o=Number(o)-1),i.data("num",o),0>=o&&e.addClass("no-num"),i.text(l(o)))}):a(s,function(a){var n={linkid:t.data("linkid"),linktype:t.data("linktype"),trackid:$("body").attr("data-trackid_special"),tagid:s};rec_rp("search_click",n),a&&0==a.code?(t.addClass("has-atten"),t.text("已关注"),Number(o)&&(o=Number(o)+1),i.data("num",o),o>0&&e.hasClass("no-num")&&e.removeClass("no-num"),i.text(l(o))):new window.MessageBox({focusShowPos:"down",Overlap:!0}).show(t,a&&a.message?a.message:"关注失败",1e3,"error")})}function a(t,e){var i={url:o+"/x/tag/subscribe/add",type:"POST",data:{jsonp:"jsonp",tag_id:t},xhrFields:{withCredentials:!0},success:e};postJSONLite(i)}function n(t,e){var i={url:o+"/x/tag/subscribe/cancel",type:"POST",data:{jsonp:"jsonp",tag_id:t},xhrFields:{withCredentials:!0},success:e};postJSONLite(i)}function s(){r&&r.each(function(t){var e=$(this).children(".js-tag-btn"),i=e.data("tagid");$.ajax({url:o+"/x/tag/info",type:"GET",dataType:"jsonp",data:{jsonp:"jsonp",tag_id:i},xhrFields:{withCredentials:!0}}).then(function(t){t&&0==t.code&&t.data&&t.data.is_atten&&(e.addClass("has-atten"),e.text("已关注"))})})}function l(t){var t=String(t);return t.length>=5?(Number(t)/1e4).toFixed(1)+"万":t}var o="//api.bilibili.com",r=$(".tag-att-wrap");return{init:t,unLoginInit:e}}(),y={rocket_top:$(".so-rocket>.rocket-icon"),is_rightDown:!1,is_righting:!1,is_rocketShow:!1,hoverAnimator:null,rocketBacking:new Event,rocketAnimating:new Event,rocketShow:function(){this.rocket_top.fadeIn("slow",function(){})},rocketHide:function(){this.rocket_top.fadeOut("slow",function(){})},rocketAnimatorInit:function(){},rocketBackToTop:function(){},rightGirlRecover:function(){this.right_girl_hover.hide(),this.right_girl_wrap.off()},rightGirlDown:function(){this.is_righting=!0;var t=$(".top-33").offset().left;$(".top-33").css({position:"fixed",left:t});var e=this,i=.55*screen.availHeight||300;this.right_rope.animate({height:i},300,function(){e.is_rightDown=!0,e.is_righting=!1,e.right_girl_wrap.hover(function(){e.right_girl.hide(),e.right_girl_hover.show()},function(){e.right_girl.show(),e.right_girl_hover.hide()}),e.right_girl_wrap.click(function(t){e.rightGirlUp(),$("body,html").stop(!0).animate({scrollTop:0},300)})})},rightGirlUp:function(){if(!this.is_rightDown)return!1;this.right_girl.show(),this.is_righting=!0,this.right_girl_wrap.off(),this.right_girl_hover.hide(),this.right_girl_wrap.removeClass("text");var t=this;this.right_rope.stop().animate({height:"120"},300,function(){t.is_rightDown=!1,t.rightGirlRecover(),t.is_righting=!1,t.right_girl_wrap.off(),$(".top-33").css({position:"absolute",left:988}),t.right_rope.css({height:0})})},init:function(){var t=this,e=!1;t.rocket_top.hover(function(){t.hoverAnimator=new Animator({element:t.rocket_top,frameSource:"//static.hdslb.com/bl2se/images/rocket_frame.png",frameWidth:150,frameHeight:174,totalFrame:5,fps:10}),t.hoverAnimator.start(0)},function(){t.hoverAnimator.stop(),t.rocket_top.css({background:"url(//static.hdslb.com/bl2se/images/rocket_top.png)"})}),t.rocketAnimating.attach(function(e,i){t.rocketAnimator.start()}),t.rocketBacking.attach(function(e,i){$("body,html").stop(!0).animate({scrollTop:0},500,function(){t.rocketHide()})}),t.rocket_top.click(function(e){t.rocketBacking.notify()}),$(window).scroll(function(){var i=$(window).height(),a=$(window).scrollTop();if(a>i/2){if($(".footer").offset().top<$(document).scrollTop()+$(window).height()){var n=$(document).scrollTop()+$(window).height()-$(".footer").offset().top;$(".rocket-con").css({bottom:n+150+"px"})}else $(".rocket-con").css({bottom:"150px"});t.is_rocketShow||(t.is_rocketShow=!0,t.rocketShow()),e||(e=!0,$("#search-wrap").addClass("distort").hide().fadeIn("fast"),$("#search-wrap.distort .input-wrap").focus(function(t){$("#search-block").css({borderColor:"#00a1d6"})}))}else t.is_rocketShow&&(t.is_rocketShow=!1,t.rocketHide()),e&&($("#search-keyword").blur(),$(".js-search-wrap").append($("#search-wrap").removeClass("distort")),e=!1);return!1}).scroll()}},b={$wrapper:$(".so-wrap"),timer:null,init:function(t){this.bindScroll()},bindScroll:function(){var t=this;$(window).on("scroll.lazyload",function(){t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){var e=t.$wrapper.find('img[data-loaded="false"]');e.each(function(t,e){if($(window).scrollTop()-100<$(e).offset().top&&$(e).offset().top+$(e).outerHeight()<$(window).innerHeight()+$(window).scrollTop()+100){var i=$(e).attr("data-src"),a=$(e).attr("data-width"),n=$(e).attr("data-height");try{i=utils.webp(i,{w:a,h:n})}catch(s){}$(e).attr({src:i,"data-loaded":!0}),$(e).removeAttr("data-src").removeAttr("data-width").removeAttr("data-height")}})},200)})},getUnloadedImg:function(){this.unLoadedImgArr=this.$wrapper.find('img[data-loaded="false"]')},reinit:function(){$(window).scroll()}};b.init();var k=function(t,e,i,a){var n=url("?")||{};if(n)for(var s in n)"keyword"!=s&&delete n[s];var l,o="";if(1==arguments.length)l=t+commonUtils.objToEncodeStr(n);else{n[t]=e;var r=i?location.pathname.split("/").slice(0,-1).join("/")+"/"+i:location.pathname;l=r+commonUtils.objToEncodeStr(n)}"suggest"===a&&(o="&from_source=web_suggest"),window.location.href="//"+location.host+l+o},C=function(){function t(t){t.preventDefault();var e=!("block"!=$(".bilibili-suggest").css("display")||!$(".vertical-text").hasClass("focus"));if(e)return!1;var i=$(this).parents(".logo-input").find("input").val().replace(/[<>]/gi,"").replace(/^\s*/,""),a=new RegExp("^av[0-9]+$","i");return i?a.test(i)?(k("keyword",i,"video"),!1):(SearchHistory.save(o(i)),void k("keyword",i)):(window.location.href="//search.bilibili.com",!1)}function e(t){t.preventDefault();var e=$(this).data("href");k(e)}function i(){n.button.click(t),n.input.keydown(function(e){13==e.keyCode&&t.call(this,e)}),n.tag.click(e),a=url("?")?url("?").keyword:null}var a,n={button:$("#search-button,.loupe"),tag:$(".nav-sub .sub"),input:$(".input-wrap input")};return{init:i}}(),_=function(){function t(){a.defaultSource=a.defaultSource(),a.static_val.hotwords=a.static_val.hotwords(),e=$("#search-keyword").bilibiliSuggestion(a);$(".bilibili-suggest").on("click",".fake-a",function(t){t.preventDefault();var e=$(this).data("target"),i=$(this).data("href"),a=$(this).data("value"),n="";$(this).hasClass("keyword")&&(n="suggest"),"blank"==e?window.open(i):k("keyword",a,"",n)}).on("mouseenter",".accurate-wrap",function(t){t.preventDefault(),$(this).find(".more").hasClass("js-hasmore")&&$(this).addClass("active").siblings(".accurate-wrap").removeClass("active").css("background","#fff").find(".js-hasmore").hide()})}var e,i="",a={container:'<div class="bilibili-suggest"></div>',appendTo:"#search-block>.input-wrap",position:{top:"100%",left:0},source:function(t,e){var a=$.trim(t.term),n={func:"suggest",suggest_type:suggestionOpt.suggestType,sub_type:suggestionOpt.subType,main_ver:"v1",highlight:"",userid:window.uid||0,bangumi_acc_num:1,special_acc_num:1,upuser_acc_num:3,topic_acc_num:1,tag_num:10,special_num:10,bangumi_num:10,upuser_num:3,term:a,rnd:Math.random()};"a"==$.cookie("abtest_suggest")&&$.extend(!0,n,{abtest:$.cookie("abtest_suggest")}),$.getJSON(search_utils.main_url+"/main/suggest?jsoncallback=?",n,function(t){t.result?(i=t.stoken,e(t.result)):e(null)})},defaultSource:function(){for(var t=SearchHistory.read(),e=0,i=t.length;i>e;++e)t[e].value=o(t[e].value);return 0!=t.length?t:utils.localStorage.getItem("hotword")?utils.localStorage.getItem("hotword").split(","):null},search:function(){var t=$.trim(this.value);return this.value&&!t||t.charCodeAt(0)<255&&t.length<1||t.length>40?!1:void 0},css:{marginTop:"5px"},renderMenu:function(t,e){var i=this;if($.isArray(e)){var n=SearchHistory.history.length;if(n){var s=t.append('<div class="hot-wrap_tag"></div>').find(".hot-wrap_tag");$.each(a.static_val.hotwords,function(t,e){if(e){var a={name:e,index:t+1};a.TYPE="hotword_tag",i._renderItem(s,a)}});var l=t.append('<div class="history-wrap"><div class="title"><span>搜索历史</span></div><a href="javascript:;" class="clearall">清空搜索历史</a></div>').find(".history-wrap");return $.each(e,function(t,e){if(e.isHistory){if(suggestionOpt.historyLen&&t>=suggestionOpt.historyLen)return}else delete e.url;e.TYPE="history",e.index=t+1,i._renderItem(l,e)}),void l.find(".clearall").mousedown(function(t){return t.stopImmediatePropagation(),SearchHistory.clear(),i._initSource("defaultSource"),$("#search-keyword").focus(),!1})}var o=t.append('<div class="hot-wrap_list"><div class="title"><span>热搜榜</span></div></div>').find(".hot-wrap_list");return void $.each(a.static_val.hotwords,function(t,e){if(e){var a={name:e,index:t+1};a.TYPE="hotword_list",i._renderItem(o,a)}})}var r=0;if(e.tag){var c=t.append('<div class="keyword-wrap"><div class="title"><span>关键字</span></div></div>').find(".keyword-wrap");$.each(e.tag,function(t,e){e&&(e.TYPE="keyword",e.index=t+1,i._renderItem(c,e),r++)}),rec_rp("show","showSuggest",!0),window.reportMsgObj.showSuggest={mid:window.UserStatus.isLogin()?$.cookie("DedeUserID"):"",keyword:encodeURI(url("?keyword"))}}0==r&&this.close()},select:function(t,e){var a=window.UserStatus&&window.UserStatus.status(),n="",s=e.item.TYPE;n="hotword_tag"===s?"hotword":"history"===s?"history":"sug",rec_rp("clickSug",{seid:i,buvid:$.cookie("buvid3")||"",mid:a&&a.mid||"",pos:e.item.index,keyword:e.item.value||e.item.name,type:n}),k("keyword",e.item.value)},static_val:{accurate_type:{upuser:"UP主",bangumi:"番剧",special:"专题",pgc:"影视"},hotwords:function(){return utils.localStorage.getItem("hotword")?utils.localStorage.getItem("hotword").split(","):[]},accurate_tpl:['<div class="accurate-wrap fake-a" data-href="{url}" data-target="blank">','<p class="vertical-text accurate "><span class="type">{type}</span>{title}</p>'].join(""),keyword_tpl:'<p data-href="{url}" class="vertical-text keyword fake-a" se-linkid="sug_keyword_{index}">{title}</p>',history_tpl:'<p data-href="{url}" class="vertical-text history fake-a" se-linkid="sug_history_{index}">{title}<i class="clear"></i></p>',hotword_list_tpl:'<a href="{url}" class="vertical-text hot" se-linkid="sug_hotList_{index}"><span class="rank">{index}</span>{title}</a>',hotword_tag_tpl:'<a href="{url}"><span class="tag" se-linkid="sug_hotTag_{index}">{title}</span></a>'},renderItem:function(t,i){var n=a.renderItemType[i.TYPE](i),s=this,l=$(n).attr("data-value",i.value).appendTo(t);return"history"==i.TYPE&&l.find("i").click(function(t){t.stopImmediatePropagation(),SearchHistory.remove(i.value);for(var a=SearchHistory.read(),n=0,l=a.length;l>n;++n)a[n].value=o(a[n].value);return 0!=a.length?s.options.defaultSource=a:s.options.defaultSource=utils.localStorage.getItem("hotword")?utils.localStorage.getItem("hotword").split(","):null,s._initSource("defaultSource"),$(this).parent().remove(),SearchHistory.history.length||(e.close(),$("#search-keyword").focus()),!1}),l},renderItemType:{accurate:function(t){var e=a.static_val.accurate_tpl,i=new Date(1e3*t.starttime).getFullYear(),n=t.isbangumi_end?"(共"+t.newep+"话)":"更新至第"+t.newep+"话";n=t.newep?n:"";var s=t.isbangumi_end?"已完结"+n:n,l=t.styles?t.styles.split(",").slice(0,2).join("/"):"",o=t.description?!1:"暂无信息";return e+="bangumi"==t.type||"pgc"==t.type?['<div class="more {hasmore}">','   <p class="titles">','      <span class="date">{year}</span>','      <span class="status">{status}</span>','      <span class="tag">{styles}</span>',"    </p>",'   <p class="detail">{detail}</p>',"</div></div>"].join("").replace(/\{hasmore\}/,"js-hasmore").replace(/\{year\}/,i||"").replace(/\{status\}/,s).replace(/\{styles\}/,l).replace(/\{detail\}/,o||t.description):"</div>".replace(/\{hasmore\}/,""),e.replace(/\{title\}/,t.name).replace(/\{url\}/,t.url).replace(/\{type\}/,a.static_val.accurate_type[t.type])},keyword:function(t){return a.static_val.keyword_tpl.replace(/\{title\}/,t.name).replace(/\{url\}/,location.pathname+"?keyword="+t.value).replace(/\{index\}/,t.index)},history:function(t){return a.static_val.history_tpl.replace(/\{title\}/,commonUtils.subString(t.value,40)).replace(/\{url\}/,location.pathname+"?keyword="+t.value).replace(/\{index\}/,t.index)},hotword_list:function(t){return a.static_val.hotword_list_tpl.replace(/\{title\}/,t.name).replace(/\{index\}/gi,t.index).replace(/\{url\}/,"/all?keyword="+t.name)},hotword_tag:function(t){return a.static_val.hotword_tag_tpl.replace(/\{title\}/,t.name).replace(/\{url\}/,location.pathname+"?keyword="+t.name).replace(/\{index\}/gi,t.index)}}};return{init:t}}(),S=function(){function t(){commonUtils.ajax(search_utils.main_url+"/main/hotword",function(t){var e=[];t.list&&t.list.length>0&&$.each(t.list,function(t,i){return e.push(i.keyword),t>=9?!1:void 0}),utils.saveToLocal("hotword",e.join(",")),_.init()})}return{init:t}}();S.init(),C.init(),loadLoginStatus(),y.init(),"pgc"==commonUtils.whereImI()?c.init():"live"==commonUtils.whereImI(),onLoginInfoLoaded(function(t){"all"==commonUtils.whereImI()?t.isLogin?(w.init(),g.init("synthetical-up")):(w.unLoginInit(),$(".synthetical-up").on("click",".js-attention-user",function(){biliQuickLogin(function(){location.reload()})})):"upuser"==commonUtils.whereImI()&&(t.isLogin?g.init("ajax-render"):$(".ajax-render").on("click",".js-attention-user",function(){biliQuickLogin(function(){location.reload()})}))});var x=function(){function t(t){g.helpful=t,a()}function e(t){g.supplement=t,a()}function i(){return!!(200>=w&&(g.helpful||g.supplement))}function a(){i()?f.addClass("active"):f.removeClass("active")}function n(){t(""),e(""),w=0,h.empty(),h.remove()}function s(){var t='<div id="feedback" class="feedback-mask"><div class="content"><i id="fbCloseBtn" class="icon-del"></i><h3 class="headline">搜索结果反馈</h3><div class="feedback-body"><dl class="dl-item"><dt class="dt-item">您觉得这个搜索结果</dt><dd class="dd-item"><label><input type="radio" value="yes" name="helpful" class="helpful"><i class="radio-icon"></i>有用</label></dd><dd class="dd-item"><label><input type="radio" value="no" name="helpful" class="helpful"><i class="radio-icon"></i>无用</label></dd></dl><dl class="dl-item"><dt class="dt-item">其它补充</dt><dd class="dd-item"><textarea name="" class="supplement"></textarea><div class="num-prompt"><span id="supplementNum">0</span>/200</div><span id="supplementError"><i class="icon-attention"></i>已经满200字啦</span></dd></dl><div class="feedback-submit">提交</div></div></div></div>';$(t).appendTo($("body")),h=$("#feedback"),f=$(".feedback-submit"),m=$("#supplementError"),p=$("#supplementNum"),v=$("#fbCloseBtn"),h.show()}function l(){var e=$("#feedback .helpful");e.on("change",function(){for(var i=0;i<e.length;i++)if(e[i].checked){t(e[i].value);break}})}function o(){$(".supplement").on("keyup input",function(){var t=$(this).val(),i=0;i=t?t.length:0,w=i,p.html(i),t.length>200?(p.addClass("error"),m.show()):(p.removeClass("error"),m.hide()),e(t)})}function r(t){$(".feedback-submit").on("click",function(){if($(this).hasClass("active")){if(!i())return;var e=$(t).attr("lnk-subtype"),a={linkid:"submit_feedback",msg:JSON.stringify(g),linktype:e?e:"upuser",trackid:$("body").attr("data-trackid_special")};rec_rp("search_click",a),window.reportMsgObj.search_click={linkid:"submit_feedback",linktype:e?e:"upuser",msg:JSON.stringify(g)},n(),d()}})}function c(){v.on("click",function(){n()})}function d(){$('<div class="fb-success-prompt">感谢反馈</div>').appendTo($("body")).fadeIn("normal",function(){var t=$(this);setTimeout(function(){t.fadeOut("normal",function(){$(this).empty().remove()})},1500)})}function u(t){s(),l(),o(),r(t),c()}var h,f,m,p,v,g={helpful:"",supplement:""},w=0;return{init:u}}();$("body").on("click",".up-fb-btn",function(){x.init(this)})}),$(function(){function t(){"function"==typeof window.biliQuickLogin?window.biliQuickLogin(function(){window.location.reload()}):$.getScript("https://static.hdslb.com/account/bili_quick_login.js",function(){window.biliQuickLogin(function(){window.location.reload()})})}function e(t,e,i){clearTimeout(s),$("body .search-global-hint").remove();var a=$('<div class="search-global-hint">'+e+"</div>");$("body").append(a);var n=$(t).offset().left-(a.outerWidth()-$(t).outerWidth())/2,l=$(t).offset().top-$(t).height()-8;a.css({top:l,left:n}).fadeIn(),i&&(s=setTimeout(function(){a.fadeOut()},i))}function i(){$("body .search-global-hint").remove()}function a(t){return $.ajax({url:"//api.bilibili.com/x/v2/history/toview/add",type:"POST",data:{aid:t,jsonp:"jsonp"},dataType:"json",xhrFields:{withCredentials:!0}})}function n(t){return $.ajax({url:"//api.bilibili.com/x/v2/history/toview/del",type:"POST",data:{aid:t,jsonp:"jsonp"},dataType:"json",xhrFields:{withCredentials:!0}})}var s=null;$("body").on("click",".search-watch-later",function(i){i.stopPropagation(),i.preventDefault();var s=$(this),l=$("body").attr("data-trackid"),o=s.attr("data-aid"),r=s.attr("data-uid");window.UserStatus&&window.UserStatus.isLogin()?s.hasClass("icon-later-on")?(rec_rp("search_click",{trackid:l,linktype:"watchlater_cancel",linkid:r?"up_"+r+"_video_"+o:"video_"+o,linkurl:s.parents("a:eq(0)").attr("href")}),n(o).done(function(t){0===t.code?(s.removeClass("icon-later-on").addClass("icon-later-off"),e(s,"已从稍后再看列表中移除",1500)):e(s,t.message,1500)}).fail(function(){e(s,"操作失败，请重试",1500)})):(rec_rp("search_click",{trackid:l,linktype:"watchlater_add",linkid:r?"up_"+r+"_video_"+o:"video_"+o,linkurl:s.parents("a:eq(0)").attr("href")}),a(o).done(function(t){0===t.code?(s.removeClass("icon-later-off").addClass("icon-later-on"),e(s,"已加稍后再看",1500)):e(s,t.message,1500)}).fail(function(){e(s,"添加失败，请重试",1500)})):t()}).on("mouseover",".search-watch-later",function(){var t=$(this).hasClass("icon-later-on")?"移除":"稍后再看";e($(this),t)}).on("mouseleave",".search-watch-later",function(){i()})}),$(function(){function t(t){r>o?o++:o=1,$.ajax({url:"/ajax_api/recommend",dataType:"json",data:{keyword:l,page:o},success:function(t){n.html(t.html).attr("data-trackid",t.trackid).attr("data-text",t.text),r=t.numPages,i(),e()}})}function e(){var t=Number(s.attr("data-total")),e=$(".separate").find(".txt"),i=$(".separate").find(".i-txt");0===t?(e.text("肥肠抱歉，没有找到你要的内容 T_T"),i.hide()):t>0&&6>t?(e.text("宝宝尽力了，只找到这些"),i.show(),i.hasClass("only")||i.addClass("only")):(e.text("看完了呢，没过瘾？"),i.show(),i.hasClass("only")&&i.removeClass("only"))}function i(){var t=Array.prototype.slice.call(n.find(".recom-pic"));for(var e in t){var i=$(t[e]),a=i.data("width"),s=i.data("height"),l=i.data("src");i.attr("src",utils.webp(l,{w:a,h:s}))}}function a(t){var e=t.attr("se-linkid"),i=void 0==t.attr("title")?"":t.attr("title"),a=void 0==t.attr("lnk-type")?"":t.attr("lnk-type"),s=n.attr("data-trackid"),o=window.UserStatus&&window.UserStatus.status();rec_rp("search_click",{linkid:e,linktitle:i,linktype:a,trackid:s,keyword:l}),window.reportMsgObj.search_click={linkid:e,linktitle:i,mid:o&&o.mid||0,linktype:a,trackid:s}}var n=$(".recom-wrap"),s=$("body"),l=s.data("keyword"),o=1,r=2;n.on("click",".recom-change",function(e){var i=$(e.target||e.srcElement);a(i),t()})}),$(function(){var t=$(".so-wrap").find(".act-card-wrap");t.on("click",".see-more",function(e){t.find(".act-last").show(),$(this).hide()})}),$(function(){function t(t,a){var n="/card",s=encodeURI("/ajax_api/"+n.split("/").slice(-1).toString().toLowerCase()),l={};l._=(new Date).getTime(),l.search_type="card",l.keyword=t,$.ajax({url:s,dataType:"json",data:l}).then(function(t){var n=t.html;i.html(n),e(a);var s=i.find(".card-wrap").attr("data-trackid");$("body").attr("data-trackid_special",s)})}function e(t){var e=t.siblings(".active").data("cardid"),i=t.data("cardid"),n="videocard_season_"+e+"_"+i,s=void 0==t.attr("title")?"":t.attr("title"),l="videocard",o=$("body").attr("data-trackid_special"),r=window.UserStatus&&window.UserStatus.status();rec_rp("search_click",{linkid:n,linktitle:s,linktype:l,trackid:o,keyword:a}),window.reportMsgObj.search_click={linkid:n,linktitle:s,mid:r&&r.mid||0,linktype:l,trackid:o}}var i=$(".synthetical-card"),a=$("body").data("keyword");i.length&&(i.on("click",".videos",function(t){var e=$(t.target||t.srcElement);e.hasClass("open")?(e.parents(".video-part").hide(),e.parents(".video-part").siblings(".video-all").show()):e.hasClass("close")&&(e.parents(".video-all").hide(),e.parents(".video-all").siblings(".video-part").show())}),i.on("click",".seasons",function(e){var i=$(e.target||e.srcElement);if(i.hasClass("season")){var a=$(".cardhead").find(".title").attr("title")+" "+i.text();t(a,i),i.siblings().removeClass("active"),i.addClass("active")}}))});